%% t1, t2, C, a, b
t1 = eye(15)*30e-3; %s
t2 = eye(15)*40e-3; %s

C = diag([1218.9, 1103.5, 201.6, 658.3, 525.1, 316.8, 771.8, 717.5,...
                       1177.4,   276, 557.2, 407.9, 479.8, 589.8, 192.9]);  % Newtons

%% M
M = 1e-3*[0.0390675, 0.0310464, -0.0287745, 0.0097311, 0.0081247, 0.013329, -0.016065,     0,    0,    0,    0,     0,    0,     0,     0;... % mm because of the 1e-3
                    15.5,     -34.1,      -17.9,      56.5,     -5.33,     30.7,      6.93,     0,    0,    0,    0,     0,    0,     0,     0;...
                    5.08,      1.88,      -8.58,      9.61,      5.84,     4.19,     -4.88,     0,    0,    0,    0,     0,    0,     0,     0;...
                       0,         0,          0,         0,      45.8,     45.8,     -19.6, -19.6, 22.7, 78.6, 14.5,  13.0, 13.6,  13.1, -2.66;...
                       0,         0,          0,         0,     -12.8,    -12.8,         0,     0,    0, 5.09, 9.95,  1.97, 1.17, -0.22, -0.69;...
                       0,         0,          0,         0,         0,        0,         0,     0,    0,    0,    0,  14.9, 14.9, -11.5, -6.30;...
                       0,         0,          0,         0,         0,        0,         0,     0,    0,    0,    0, -7.47, 21.8, -17.3,  25.1];

%% I, D, K
I = [ 0.269,      0,     0,  0.076,      0,     0, -0.014;... % kgm^2
               0,  0.196, 0.083,      0, -0.002, 0.009,      0;...
               0,  0.083, 0.079,      0,      0, 0.011,      0;...
           0.076,      0,     0,  0.076,      0,     0, -0.012;...
               0, -0.002,     0,      0,  0.002,     0,      0;...
               0,  0.009, 0.011,      0,      0, 0.003,      0;...
          -0.014,      0,     0, -0.012,      0,     0,  0.003];

D = [0.756, 0.184, 0.020, 0.187,     0,      0,      0;... % Nms/rad
          0.184, 0.383, 0.267,     0,     0,      0,      0;...
          0.020, 0.267, 0.524,     0,     0,      0,      0;...
          0.187,     0,     0, 0.607,     0,      0,      0;...
              0,     0,     0,     0, 0.021,  0.001,  0.008;...
              0,     0,     0,     0, 0.001,  0.028, -0.003;...
              0,     0,     0,     0, 0.008, -0.003,  0.082];

K = [10.80, 2.626, 0.279, 2.670,     0,      0,      0;... % Nm/rad
          2.626, 5.468, 3.821,     0,     0,      0,      0;...
          0.279, 3.821, 7.486,     0,     0,      0,      0;...
          2.670,     0,     0, 8.670,     0,      0,      0;...
              0,     0,     0,     0, 0.756,  0.018,  0.291;
              0,     0,     0,     0, 0.018,  0.992, -0.099;...
              0,     0,     0,     0, 0.291, -0.099,  2.920];

%% Tremor band
frequency_band = (0.1:0.1:15);
tremor_band = [4, 8] * 10;
w2 = 2 * pi * frequency_band;

%% Jacobian parameters and variables here
load('mats/Jacobian.mat', 'J');
syms q1 q2 q3 q4 q5 q6 q7

% LINK LENGTHS
% - Length upper arm (Lua): 0.2853 m
% - Length forearm (Lfa): 0.2723 m
% - Distance from axis (wrist) to center of mass of hand (Lh): 0.069 m
h = 0.069;
f = 0.2723;
u = 0.2853;
L = [h, f, u];

% Position variable for posture 1
% Check: Fundamental Principles of Tremor Propagation in the Upper Limb by
% Davidson and Charles at Fig 1 for values for different postures
q = [-pi/2 pi/2 pi/2 pi/2 pi/2 -pi/2 0];
J = subs(J, [q1 q2 q3 q4 q5 q6 q7], q);

%% array to hold the values as chars symbolically for plotting
t1_char = {'t1'};
t2_char = {'t2'};
I_char = {'I11', 'I41', 'I71', 'I22', 'I32', 'I52', 'I62', 'I33', 'I63', 'I44', 'I74', 'I55', 'I66', 'I77'};
D_char = {'D11', 'D21', 'D31', 'D41', 'D22', 'D32', 'D33', 'D44', 'D55', 'D65', 'D75', 'D66', 'D76', 'D77'};
K_char = {'K11', 'K21', 'K31', 'K41', 'K22', 'K32', 'K33', 'K44', 'K55', 'K65', 'K75', 'K66', 'K76', 'K77'};
M_char = {'M11', 'M12', 'M13', 'M14', 'M15', 'M16', 'M17', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M31', 'M32', 'M33', 'M34', 'M35', 'M36', 'M37', 'M45', 'M46', 'M47', 'M48', 'M49', 'M410', 'M411', 'M412', 'M413', 'M414', 'M415', 'M55', 'M56', 'M510', 'M511', 'M512', 'M513', 'M514', 'M515', 'M612', 'M613', 'M614', 'M615', 'M712', 'M713', 'M714', 'M715'};
C_char = {'C11', 'C22', 'C33', 'C44', 'C55', 'C66', 'C77', 'C88', 'C99', 'C1010', 'C1111', 'C1212', 'C1313', 'C1414', 'C1515'};
L_char = {'Lh', 'Lfa', 'Lua'};
params_char = {'t1', 't2', 'I11', 'I41', 'I71', 'I22', 'I32', 'I52', 'I62', 'I33', 'I63', 'I44', 'I74', 'I55', 'I66', 'I77', 'D11', 'D21', 'D31', 'D41', 'D22', 'D32', 'D33', 'D44', 'D55', 'D65', 'D75', 'D66', 'D76', 'D77', 'K11', 'K21', 'K31', 'K41', 'K22', 'K32', 'K33', 'K44', 'K55', 'K65', 'K75', 'K66', 'K76', 'K77', 'M11', 'M12', 'M13', 'M14', 'M15', 'M16', 'M17', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M31', 'M32', 'M33', 'M34', 'M35', 'M36', 'M37', 'M45', 'M46', 'M47', 'M48', 'M49', 'M410', 'M411', 'M412', 'M413', 'M414', 'M415', 'M55', 'M56', 'M510', 'M511', 'M512', 'M513', 'M514', 'M515', 'M612', 'M613', 'M614', 'M615', 'M712', 'M713', 'M714', 'M715', 'C11', 'C22', 'C33', 'C44', 'C55', 'C66', 'C77', 'C88', 'C99', 'C1010', 'C1111', 'C1212', 'C1313', 'C1414', 'C1515', 'Lh', 'Lfa', 'Lua'};
